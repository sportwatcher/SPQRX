% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SPQRX.R
\name{fit.spqr}
\alias{fit.spqr}
\title{Fit SPQR Model}
\usage{
fit.spqr(
  input_dim,
  hidden_dim,
  n.knots,
  x_training,
  x_validation,
  y_training,
  y_validation,
  hyperparameter = NULL,
  pre_normalize = FALSE,
  package.it = TRUE
)
}
\arguments{
\item{input_dim}{Integer. Number of covariates (input features).}

\item{hidden_dim}{Integer vector specifying hidden layer sizes.}

\item{n.knots}{Integer. Total number of spline basis functions.}

\item{x_training}{Numeric matrix of training covariates.}

\item{x_validation}{Numeric matrix of validation covariates.}

\item{y_training}{Numeric vector or matrix of training responses.}

\item{y_validation}{Numeric vector or matrix of validation responses.}

\item{hyperparameter}{List created by
\code{create.packages.hyperparameter()} specifying training
configuration (e.g., epochs, batch size).}

\item{pre_normalize}{Logical. Included for API consistency.
Currently does not alter preprocessing behavior.}

\item{package.it}{Logical. If TRUE (default), returns a structured
\code{"spqrx_model"} object. If FALSE, returns the raw
\code{keras_model}.}
}
\value{
If \code{package.it = TRUE}, returns an object of class
\code{"spqrx_model"} containing:
\itemize{
  \item The trained keras model
  \item Spline knot locations
  \item Normalization parameters
  \item Variable names (if available)
}

Otherwise, returns a trained \code{keras_model} object.
}
\description{
Fits the baseline SPQR (Spline-based Probabilistic Quantile Regression)
model using a neural network parameterization of spline mixture weights.
}
\details{
This function performs:
\itemize{
  \item Response rescaling to the unit interval
  \item Covariate standardization using combined training/validation statistics
  \item Construction of spline basis and integrated basis matrices
  \item Neural network training via \code{in.fit.spqr()}
}

The fitted model can optionally be returned as a packaged
\code{"spqrx_model"} object containing normalization metadata
and spline information for downstream prediction and explainability.


The response variable is internally rescaled to the unit interval
prior to spline construction. Covariates are standardized using
mean and standard deviation computed from the combined
training and validation data.
}
\seealso{
\code{\link{fit_spqrx}}, \code{\link{predict_spqrx}}
}
\keyword{internal}
