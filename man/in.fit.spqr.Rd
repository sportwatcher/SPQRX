% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SPQRX.R
\name{in.fit.spqr}
\alias{in.fit.spqr}
\title{Fit Base SPQR Neural Network (Internal Training Routine)}
\usage{
in.fit.spqr(
  input_dim,
  hidden_dim,
  n.knots,
  knots,
  x_training,
  x_validation,
  y_training,
  y_validation,
  m_basis_training,
  m_basis_validation,
  i_basis_training,
  i_basis_validation,
  hyperparameter = NULL
)
}
\arguments{
\item{input_dim}{Integer. Number of covariates (input features).}

\item{hidden_dim}{Integer vector. Number of units in each hidden layer.}

\item{n.knots}{Integer. Total number of spline basis functions.}

\item{knots}{Numeric vector of spline knot locations.}

\item{x_training}{Numeric matrix of training covariates.}

\item{x_validation}{Numeric matrix of validation covariates.}

\item{y_training}{Numeric vector or matrix of training responses.}

\item{y_validation}{Numeric vector or matrix of validation responses.}

\item{m_basis_training}{Numeric matrix of spline basis evaluations
for the training responses.}

\item{m_basis_validation}{Numeric matrix of spline basis evaluations
for the validation responses.}

\item{i_basis_training}{Numeric matrix of integrated spline basis
evaluations for the training responses.}

\item{i_basis_validation}{Numeric matrix of integrated spline basis
evaluations for the validation responses.}

\item{hyperparameter}{List. Model training configuration created by
\code{create.packages.hyperparameter()}, containing elements such
as `epochs`, `batch_size`, and `activation`.}
}
\value{
A trained \code{keras_model} object corresponding to the
  fitted SPQR architecture.
}
\description{
Internal training routine for the baseline SPQR (Spline-based
Probabilistic Quantile Regression) model. This function builds
the neural network architecture, compiles it with the SPQR
negative log-likelihood loss, and performs supervised training
using precomputed spline basis matrices.
}
\details{
This function assumes that:
\itemize{
  \item Covariates and responses have already been preprocessed.
  \item Spline basis matrices (`m_basis_*`, `i_basis_*`) have
        already been constructed.
  \item Hyperparameters are supplied via a structured list.
}

It is not intended to be called directly by end users.


The model is trained using the \code{nloglik_loss_SPQR} loss
function and the Adam optimizer. Early stopping is applied
based on validation loss, and the best-performing weights are
saved during training.
}
\seealso{
\code{\link{fit.spqr}}, \code{\link{SPQRX}}
}
\keyword{internal}
